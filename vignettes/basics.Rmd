---
title: "Including  exercises in parent documents"
output: rmarkdown::html_vignette
vignette: >


  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
library(etude)
knitr::opts_chunk$set(
  answers=FALSE, documentation=TRUE
)
```

Ã‰tude works with sets of exercise files, in a specific format detailed in another vignette. This vignette shows how to include such files within another document. That might be, for example, a book written with bookdown, but it can be any file that you knit into a user-facing form. Here, the file doing the including will be this vignette's source, `basics.Rmd`. We will refer to such a document as the "parent" document, and the individual exercises files as the child documents.^[Implementation detail: etude in fact uses `knitr::knit_child()`.] 

We'll start here with the assumption that exercise files in the proper format already exist. I like to put exercise files in a package, which makes them easy to distribute to collaborating authors without revealing the answers embedded in the source file. 

Most of the examples here will use exercise files in the `inst/Exercises/` directory of this `etude` package, and the names will not include the `.Rmd` file-type suffix.  

You can also use exercise files stored in any ordinary way outside of a package. Then, you must give the full path name relative to the parent document. 

## Exercises, chunks, and inline R

Typically, you will include an etude exercise in an Rmd file by creating an R-chunk that refers specifically to the Rmd file by name. This happens when you use the `exercise=<name_of_file>` chunk option.

The work is done by the `knitr` "hook" system. Accordingly, you need to register the etude hook with `knitr` within your document. This can be done in any chunk preceeding the first chunk what refers to an exercise. A setup chunk at the top of a document is a good way to do this.

    `r ''````{r include = FALSE}
    knitr::knit_hooks$set(
      exercise = etude::exercise_hook)
    ```

```{r echo=FALSE}
knitr::knit_hooks$set(
      exercise = etude::exercise_hook)
```

An exercise chunk will look like this:

    `r ''````{r exercise="cheetah-hit-plate",name="**Example 1**:", answers=FALSE, documentation=TRUE, package = "etude"}
    
    ```
    
Note that there is nothing contained *in* the chunk. All the information used by etude comes from chunk options. 

Here's the result from the above chunk ...

```{r exercise="cheetah-hit-plate",name="**Example 1**:", answers=FALSE, documentation=TRUE, package="etude"}
```

----------

I have placed a horizontal line *after* the exercise using ordinary Markdown *outside* of the chunk. It's entirely up to you whether to include such markup after an exercise. Again, you would do so using plain, ordinary Markdown.

In the chunk including **Example 1** above, the chunk option `documentation=TRUE` was given. This is what causes the bulleted information to appear at the end of the printed exercise. This can be helpful when developing an exercise document or, perhaps, in distributing a catalog of exercises to teachers, but would not usually be something to include in files distributed to students.

As you can guess, setting `documentation=FALSE` suppresses this documentary behavior. Similarly, the chunk option `answers=FALSE` instructs etude not to put answers or such in the printed version. (Answer text can be included in an etude-format file. It's up to the author to write it! Etude doesn't do this.)

A useful practice is to set the policy regarding showing documentation and answers in the parent Rmd
file's setup chunk, with a statement like this:

    knitr::opts_chunk$set(
      answers=FALSE, 
      documentation=TRUE,
      package="myownexercisepackage"
    )

This way, you can easily change the policy globally in the document to serve different purposes. Note that you can override the global settings for any single chunk by setting that chunk's options directly.

Also note that in the above example the exercise file itself is contained in a package; here, the etude package. Doubtless you will have no reason to draw on the few examples in the etude package, so it's important to specify which package you are drawing the exercises from.

It's not required that the etude exercise files be organized into a package. You can specify the name explicitly by giving the full file name as the value of `exercise=`. The file name will, presumably, end in `.Rmd`.  In this following, the file path and name are generated using the `system.file()` function (so that the example will work with just the etude package installed), but you can use any file that's accessible on your computer.

    `r ''````{r exercise = system.file("Exercises/dog-drink-ring.Rmd", package = "etude"), name="**Exercise directly from a file**: "}
    
    ```

```{r exercise = system.file("Exercises/dog-drink-ring.Rmd", package = "etude"), name="**Exercise directly from a file**: "}
```

--------

Note that the name you give the exercise can be anything at all, and can even include Markdown or inline R code chunks.

## Sets of exercises

Often, you may want to have a section of your document containing multiple exercises in sequence. It's possible, but awkward to accomplish this with a set of chunks -- one for each exercise. The `etude_list()` function provides another mechanism that may be more flexible, since it doesn't require changing the parent Rmd to change the exercises.

First, create a data frame containing one row for each exercise, each row giving the specifics for the exercise that earlier in this document were set using chunk options. For example:

```{r}
Chap_2_exercises <- tribble(
  ~ exercise, ~ name,
  "eagle-give-clock", "**Exercise 2.1**",
  "elm-keep-plate", "**Exercise 2.2**",
  "dog-drink-ring", "**Exercise 2.3**"
) %>% mutate(
  answers = FALSE,
  documentation = FALSE,
  # Use your own exercise-containing package instead.
  # For stand-alone files, use whatever you want.
  package = "etude" 
)
```

Once you have defined the data frame listing of files, call `etude_list()` with the data frame as an argument. This **must** be done within an in-line chunk, like this:

`` `r etude_list(Chap_2_exercises)` `` 

If you want an section header for the exercises, use ordinary markdown to create the section header. Then make the inline call to `etude_list()` after the header.

Here's an example ...

## Exercises

`r etude_list(Chap_2_exercises)`



